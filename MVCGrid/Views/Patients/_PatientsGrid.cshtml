@model IEnumerable<DentalCareManagmentSystem.Application.DTOs.PatientDto>
@using NonFactors.Mvc.Grid

@(Html.Grid(Model)
    .Build(columns =>
    {
        columns.Add(model => model.FullName).Titled("Patient").Filterable(true).Sortable(true);
        columns.Add(model => model.Phone).Titled("Phone").Filterable(true).Sortable(true);
        columns.Add(model => model.Age).Titled("Age").Css("text-center").Sortable(true);
        columns.Add(model => model.Gender).Titled("Gender").Css("text-center").Filterable(true).Sortable(true);
        columns.Add(model => model.TotalDue).Titled("Total Due").Css("text-end").Encoded(false).Sortable(true)
            .RenderedAs(model => $"<span class='fw-bold {(model.TotalDue > 0 ? "text-danger" : "text-success")}'>{model.TotalDue:C}</span>");

        columns.Add(model => model.Id).Titled("Actions").Encoded(false).Filterable(false).Sortable(false)
            .RenderedAs(model => $@"
                <div class='btn-group btn-group-sm'>
                    <button type='button' class='btn btn-info' onclick='showDetails(""{model.Id}"")' title='Patient Details'><i class='fas fa-eye'></i></button>
                    <button type='button' class='btn btn-primary' onclick='showEdit(""{model.Id}"")' title='Edit Patient'><i class='fas fa-edit'></i></button>
                    <button type='button' class='btn btn-success' onclick='createAppointment(""{model.Id}"", ""{model.FullName}"")' title='New Appointment'><i class='fas fa-calendar-plus'></i></button>
                    <button type='button' class='btn btn-danger' onclick='deletePatient(""{model.Id}"", ""{model.FullName}"")' title='Delete Patient'><i class='fas fa-trash'></i></button>
                </div>");
    })
    .Id("patients-grid")
    .Using(GridFilterMode.Header)
    .Empty("No patients found")
    .Pageable(pager =>
    {
        pager.PageSizes = new Dictionary<int, string> { { 0, "All" }, { 10, "10" }, { 20, "20" }, { 50, "50" } };
        pager.ShowPageSizes = true;
        pager.RowsPerPage = 20;
    })
)
