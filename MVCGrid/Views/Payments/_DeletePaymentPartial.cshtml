@model DentalCareManagmentSystem.Application.DTOs.PaymentTransactionDto

<div class="modal-header">
    <h5 class="modal-title">Delete Payment</h5>
    <button type="button" class="close" data-dismiss="modal">&times;</button>
</div>

<form asp-action="DeletePaymentConfirmed" method="post" id="deletePaymentForm">
    <div class="modal-body">
        <input type="hidden" name="id" value="@Model.Id" />
        
        <div class="alert alert-warning">
            <i class="fas fa-exclamation-triangle"></i>
            Are you sure you want to delete this payment?
        </div>

        <dl class="row">
            <dt class="col-sm-4">Patient:</dt>
            <dd class="col-sm-8">@Model.PatientName</dd>

            <dt class="col-sm-4">Amount:</dt>
            <dd class="col-sm-8"><strong>@Model.Amount.ToString("C")</strong></dd>

            <dt class="col-sm-4">Payment Date:</dt>
            <dd class="col-sm-8">@Model.PaymentDate.ToString("dd/MM/yyyy")</dd>

            <dt class="col-sm-4">Notes:</dt>
            <dd class="col-sm-8">@Model.Notes</dd>
        </dl>
    </div>

    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-danger">
            <i class="fas fa-trash"></i> Delete Payment
        </button>
    </div>
</form>

<script>
    $('#deletePaymentForm').on('submit', function (e) {
        e.preventDefault();
        var form = $(this);

        $.ajax({
            url: form.attr('action'),
            type: 'POST',
            data: form.serialize(),
            success: function (response) {
                if (response.success) {
                    $('#actionModal').modal('hide');
                    showAlert('success', response.message);
                    location.reload();
                } else {
                    showAlert('danger', response.message);
                }
            },
            error: function () {
                showAlert('danger', 'An error occurred while deleting the payment.');
            }
        });
    });
</script>
